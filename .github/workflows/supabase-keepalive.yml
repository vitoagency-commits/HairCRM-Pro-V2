name: Keep Supabase Active

on:
  schedule:
    - cron: '0 12 * * *'
  workflow_dispatch:

jobs:
  ping-supabase:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Supabase Database
        env:
          # Qui usiamo il tuo URL reale che abbiamo visto prima
          SB_URL: "https://nmmkapltpimlksngphmk.supabase.co/rest/v1/"
          SB_KEY: ${{ secrets.SUPABASE_KEY }}
        run: |
          # Questo comando pulisce la chiave da eventuali spazi e lancia il ping
          CLEAN_KEY=$(echo $SB_KEY | tr -d '[:space:]')
          curl -i -X GET "${SB_URL}/rest/v1/app_state?select=*" \
          -H "apikey: ${CLEAN_KEY}" \
          -H "Authorization: Bearer ${CLEAN_KEY}"
